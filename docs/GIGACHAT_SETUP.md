# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GigaChat –¥–ª—è RAG SDK

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å GigaChat-2-Lite.

## üìã –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `GIGA_CHAT_MODEL`
- ‚úÖ `.env` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
- ‚úÖ `docker-compose.yml` - –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- ‚úÖ `rag_sdk/config.py` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ `llm_manager/managers/giga_chat_manager.py` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `os.getenv()`

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ gigachat
- ‚úÖ `llm_manager/requirements.txt` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ `gigachat==0.1.40`

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `OPENAI_MODEL`
- ‚úÖ –î–ª—è consistency —Å–æ –≤—Å–µ–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GigaChat

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ Auth Key

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://developers.sber.ru/gigachat
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. –ü–æ–ª—É—á–∏—Ç–µ Auth Key (Client Secret)

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç–µ .env

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ü–∏—é GigaChat:

```env
# ===========================================
# LLM Provider
# ===========================================
PROVIDER=gigachat

# --- GigaChat ---
GIGA_CHAT_AUTH_KEY=–≤–∞—à-auth-key-–∑–¥–µ—Å—å
GIGA_CHAT_MODEL=GigaChat-2-Lite
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç

```bash
docker-compose up --build
```

## üìä –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è GigaChat

```
1. .env —Ñ–∞–π–ª
   ‚Üì
   PROVIDER=gigachat
   GIGA_CHAT_AUTH_KEY=your-key
   GIGA_CHAT_MODEL=GigaChat-2-Lite
   ‚Üì
2. docker-compose.yml —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
   ‚Üì
3. –ü–µ—Ä–µ–¥–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞–∫ environment
   ‚Üì
4. llm_manager/managers/giga_chat_manager.py
   ‚Üì
   client = GigaChat(
       credentials=os.getenv('GIGA_CHAT_AUTH_KEY'),
       model=os.getenv('GIGA_CHAT_MODEL')  ‚Üê GigaChat-2-Lite
   )
   ‚Üì
5. RAGManager –≤—ã–∑—ã–≤–∞–µ—Ç get_response()
   ‚Üì
6. –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª

```bash
cat .env | grep -A 2 "GigaChat"
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
# --- GigaChat ---
# GIGA_CHAT_AUTH_KEY=your-gigachat-auth-key
GIGA_CHAT_MODEL=GigaChat-2-Lite
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ docker-compose.yml

```bash
grep GIGA_CHAT docker-compose.yml
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
GIGA_CHAT_AUTH_KEY: ${GIGA_CHAT_AUTH_KEY}
GIGA_CHAT_MODEL: ${GIGA_CHAT_MODEL:-GigaChat-2-Lite}
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

```bash
grep gigachat llm_manager/requirements.txt
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
gigachat==0.1.40
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)

```bash
docker exec rag_app env | grep GIGA_CHAT
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
GIGA_CHAT_AUTH_KEY=–≤–∞—à-–∫–ª—é—á
GIGA_CHAT_MODEL=GigaChat-2-Lite
```

## üéØ –ü–æ–ª–Ω—ã–π .env –¥–ª—è GigaChat

```env
# PostgreSQL
POSTGRES_USER=rag_user
POSTGRES_PASSWORD=rag_password
POSTGRES_DB=rag_db
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# LLM Provider
PROVIDER=gigachat

# GigaChat
GIGA_CHAT_AUTH_KEY=–≤–∞—à-auth-key-–∑–¥–µ—Å—å
GIGA_CHAT_MODEL=GigaChat-2-Lite

# Embeddings
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
CHUNK_SIZE=500
CHUNK_OVERLAP=50
```

## üîç –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ GigaChat

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–≥–æ —Ç–∞—Ä–∏—Ñ–∞, –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –º–æ–¥–µ–ª–∏:

| –ú–æ–¥–µ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–æ–∫–µ–Ω–æ–≤ | –°–∫–æ—Ä–æ—Å—Ç—å |
|--------|----------|---------|----------|
| `GigaChat` | –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å | 8192 | –°—Ä–µ–¥–Ω—è—è |
| `GigaChat-Plus` | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è | 32768 | –°—Ä–µ–¥–Ω—è—è |
| `GigaChat-Pro` | –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è | 32768 | –í—ã—Å–æ–∫–∞—è |
| `GigaChat-2-Lite` | –õ–µ–≥–∫–∞—è v2 (–±—ã—Å—Ç—Ä–∞—è) | 8192 | –ë—ã—Å—Ç—Ä–∞—è ‚ö° |

**–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ:** `GigaChat-2-Lite` - –±—ã—Å—Ç—Ä–∞—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è RAG –∑–∞–¥–∞—á.

–î–ª—è —Å–º–µ–Ω—ã –º–æ–¥–µ–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `GIGA_CHAT_MODEL` –≤ `.env`.

## üöÄ –ó–∞–ø—É—Å–∫ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç

```bash
docker-compose up --build
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

http://localhost:8000

### 3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

–ù–∞–ø—Ä–∏–º–µ—Ä, –ª—é–±–æ–π PDF –∏–ª–∏ TXT —Ñ–∞–π–ª

### 4. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GigaChat-2-Lite –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã GigaChat –≤ –∫–æ–¥–µ

–í `giga_chat_manager.py` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```python
response = cls.client.chat(
    Chat(
        messages=[...],
        temperature=0.7,      # –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (0.0-1.0)
        max_tokens=1024       # –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
    )
)
```

–≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥ –≤–∞—à–∏ –∑–∞–¥–∞—á–∏.

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **verify_ssl_certs=False** - –æ—Ç–∫–ª—é—á–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
   - –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è `verify_ssl_certs=True`

2. **Auth Key** - —Ö—Ä–∞–Ω–∏—Ç–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ git

3. **–õ–∏–º–∏—Ç—ã** - GigaChat –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∞—Ä–∏—Ñ–∞

4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç** - GigaChat-2-Lite –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ 8192 —Ç–æ–∫–µ–Ω–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "Invalid credentials"

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Auth Key
```bash
cat .env | grep GIGA_CHAT_AUTH_KEY
```

### –û—à–∏–±–∫–∞: "Model not found"

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –≤–∞—à–µ–º —Ç–∞—Ä–∏—Ñ–µ
```bash
cat .env | grep GIGA_CHAT_MODEL
```

### –û—à–∏–±–∫–∞: "gigachat module not found"

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```bash
docker-compose down
docker-compose up --build
```

### –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:** 
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GigaChat-2-Lite` (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
- –£–º–µ–Ω—å—à–∏—Ç–µ `CHUNK_SIZE` –∏ `context_limit` –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è GigaChat: https://developers.sber.ru/gigachat
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: https://github.com/ai-forever/gigachat
- –¢–∞—Ä–∏—Ñ—ã: https://developers.sber.ru/gigachat/tariffs

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

- [x] `PROVIDER=gigachat` –≤ `.env`
- [x] `GIGA_CHAT_AUTH_KEY` —É–∫–∞–∑–∞–Ω –≤ `.env`
- [x] `GIGA_CHAT_MODEL=GigaChat-2-Lite` –≤ `.env`
- [x] `gigachat==0.1.40` –≤ `requirements.txt`
- [x] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–∫–∏–Ω—É—Ç—ã –≤ `docker-compose.yml`
- [x] `giga_chat_manager.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `os.getenv()`

**–í—Å–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å GigaChat! üéâ**

